inputs:
    - {type: hive, alias: product, db: gold, table: product}
    - {type: hive, alias: date, db: gold, table: date}
    - {type: hive, alias: transactions, db: work, table: transactions}
transformations :
    - input: "product"
      alias: "product_filtered"
      persist: true
      transform:
        - {type: filter, condition: "product_desc != 'N.A.'"}
        - {type: rename, list: {product_desc: "product"}}
        - {type: select, columns: ["product_id", "product"]}
    - input: "transactions"
      transform:
        - {type: rename, list: {id: "trxn_id" , loc: "location"}}
        - {type: transform, list: {location: "lower(location)", trxn_id: "concat(trxn_id, location)"}}
        - {type: join, joinColumns: ["product"], joinType: inner, joinSource: "product_filtered"}
        - {type: join, joinColumns: ["date"], joinType: inner, joinSource: "date"}
outputs:
    - {type: hive, input: "transactions", mode: append, db: work, table: output}
